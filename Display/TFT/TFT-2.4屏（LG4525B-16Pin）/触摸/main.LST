C51 COMPILER V9.01   MAIN                                                                  12/26/2014 16:50:25 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include "REG51.H"
   2          //#include "lcd_driver.h"
   3          #include "touch.h"
   4          #include "gui.h"
   5          #include<stdio.h>
   6          
   7          /****************************************************************************
   8          *函数名：main
   9          *输  入：无
  10          *输  出：无
  11          *功  能：主函数
  12          ****************************************************************************/
  13          
  14          void main (void)
  15          {
  16   1              uchar rst = 0;
  17   1              //--多出来两个值使用来在内存上面跟别的变量分隔的--//
  18   1              uchar  xValue[6] = {0, 0, 0, 0, 0, 0}, yValue[6] = {0, 0, 0, 0, 0, 0};
  19   1              long x, y;
  20   1      
  21   1              TFT_Init();
  22   1              rst = 1;
  23   1      
  24   1              while(1)
  25   1              {
  26   2                      if(rst == 1)
  27   2                      {       
  28   3                              TFT_ClearScreen(0x0000);
  29   3                              GUI_Write32CnChar(20, 24, "普中科技", 0xF800, 0x0000);
  30   3                              GUI_Line(20, 54, 140, 54, 0xF800);
  31   3                              GUI_Line(20, 54, 140, 54, 0xF800);
  32   3                              GUI_WriteASCII(127, 0, "RST", 0xF800, 0x0000);
  33   3                              rst = 0;
  34   3                      }
  35   2      
  36   2                      if(TOUCH_XPT_ReadXY() == 1)
  37   2                      {
  38   3                              //--如果触摸跟显示发生偏移，可以根据显示AD值--//
  39   3                              //--调整下面公式里面的数值--//
  40   3                              x = xpt_xy.x;
  41   3                              //x = (x - 100) * 454 / 10000 ;
  42   3                              x = (x - 304)*175/3472; 
  43   3                              y =     xpt_xy.y;
  44   3                              //y = (y-240) * 628 / 10000;
  45   3                              y = (y - 256) *219/3440;
  46   3      
  47   3      
  48   3      
  49   3                              if (x > 175 )
  50   3                              {
  51   4                                      x = 174;
  52   4                              }
  53   3                              if (y > 219)
  54   3                              {
  55   4                                      y = 218;
C51 COMPILER V9.01   MAIN                                                                  12/26/2014 16:50:25 PAGE 2   

  56   4                              }
  57   3                              if ((x > 127) && (y < 24))
  58   3                              {
  59   4                                      rst = 1;
  60   4                              }
  61   3                              else
  62   3                              {
  63   4                                      GUI_Dot((uint)x , (uint)y, 0x001F);
  64   4                                      //--计算读取到的AD值--//
  65   4                                      //--由于添加了显示AD值，计算需要时间，所以触摸有一点延迟--//xpt_xy.
  66   4                                      xValue[1] = (xpt_xy.x % 10000 /1000) + '0';
  67   4                                      xValue[2] = (xpt_xy.x % 1000 /100) + '0';
  68   4                                      xValue[3] = (xpt_xy.x % 100 /10) + '0';
  69   4                                      xValue[4] = (xpt_xy.x % 10) + '0';
  70   4      
  71   4                                      yValue[1] = (xpt_xy.y % 10000 /1000) + '0';
  72   4                                      yValue[2] = (xpt_xy.y % 1000 /100) + '0';
  73   4                                      yValue[3] = (xpt_xy.y % 100 /10) + '0';
  74   4                                      yValue[4] = (xpt_xy.y % 10) + '0';
  75   4      
  76   4                                      //--显示AD值--//
  77   4                                      GUI_WriteASCII(0, 170, "X:", 0xF800, 0x0000);
  78   4                                      GUI_WriteASCII(32, 170, &xValue[1], 0xF800, 0x0000);    
  79   4                                      GUI_WriteASCII(0, 195, "Y:", 0xF800, 0x0000);
  80   4                                      GUI_WriteASCII(32, 195, &yValue[1], 0xF800, 0x0000);
  81   4                              }
  82   3                      }
  83   2              }
  84   1      }
  85          
  86                  


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    711    ----
   CONSTANT SIZE    =     31    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      21
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
