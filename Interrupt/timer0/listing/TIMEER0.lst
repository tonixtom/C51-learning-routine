C51 COMPILER V9.54   TIMEER0                                                               07/27/2020 10:50:40 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE TIMEER0
OBJECT MODULE PLACED IN .\output\TIMEER0.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE TIMEER0.C OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\listing\TI
                    -MEER0.lst) TABS(2) OBJECT(.\output\TIMEER0.obj)

line level    source

   1          /*******************************************************************************
   2          *  标题:                  试验数码管上显示定时器中断计数                       *
   3          *                                        *
   4          *  连接方法：参照接线图                               *
   5          ********************************************************************************
   6          *                                                            *
   7          * 请学员认真消化本例程，用单片机脚直接控制数码管和定时器中断使用               *
   8          ********************************************************************************/
   9          
  10          #include < reg51.h >
  11          #include <intrins.h>
  12          
  13          sbit LS138A=P2^2;  //定义 138管脚
  14          sbit LS138B=P2^3;
  15          sbit LS138C=P2^4; 
  16          
  17          
  18          unsigned int LedNumVal,LedOut[8];
  19          
  20          // 此表为 LED 的字模            // 0    1    2    3    4    5    6   7    8    9    A    b    c    d    E 
             -   -    L   P    U    Hidden  _ (20)
  21          unsigned char code Disp_Tab[] = { ~0xC0,~0xF9,~0xA4,~0xB0,~0x99,~0x92,~0x82,~0xF8,~0x80,~0x90,~0x88,~0x83,
             -~0xC6,~0xA1,~0x86,~0xbf,~0xc7,~0x8c,~0xc1, ~0xff,  ~0xf7 }; 
  22          
  23          
  24          /***********************************************************
  25          purpose: 系统初始化
  26          /**********************************************************/
  27          void system_Ini()
  28          {
  29   1           TMOD = 0x00; //选择模式0  13位计数 最大计数8192
  30   1        
  31   1         // TH0=0x1C;   //12.000M  预装初值
  32   1          //TL0=0x18; 
  33   1         TH0 = (8192 - 1000)/32;
  34   1         TL0 = (8192 - 1000)%32 ;
  35   1           IE = 0x8A;   //中断  
  36   1           TR0  = 1;    //开启T0定时器
  37   1      
  38   1      
  39   1      }
  40          
  41          void delay(unsigned int i)
  42          {
  43   1          char j;
  44   1          for(i; i > 0; i--)
  45   1              for(j = 200; j > 0; j--);
  46   1      }
  47          
  48          
  49          /********主函数****/
  50          main()
  51          { 
  52   1         system_Ini() ;
C51 COMPILER V9.54   TIMEER0                                                               07/27/2020 10:50:40 PAGE 2   

  53   1       
  54   1       
  55   1         while(1)
  56   1         {
  57   2        
  58   2         unsigned char i;
  59   2         
  60   2           LedOut[0]=Disp_Tab[LedNumVal%10000/1000];
  61   2           LedOut[1]=Disp_Tab[LedNumVal%1000/100];
  62   2           LedOut[2]=Disp_Tab[LedNumVal%100/10];
  63   2           LedOut[3]=Disp_Tab[LedNumVal%10];
  64   2      
  65   2      
  66   2         for( i=0; i<8; i++) 
  67   2         {   P0 = LedOut[i];
  68   3            
  69   3          switch(i)           
  70   3             {      
  71   4            case 0:LS138A=0; LS138B=0; LS138C=0; break;         
  72   4                case 1:LS138A=1; LS138B=0; LS138C=0; break;               
  73   4                case 2:LS138A=0; LS138B=1; LS138C=0; break; 
  74   4                case 3:LS138A=1; LS138B=1; LS138C=0; break; 
  75   4            case 4:LS138A=0; LS138B=0; LS138C=1; break;
  76   4            case 5:LS138A=1; LS138B=0; LS138C=1; break;
  77   4            case 6:LS138A=0; LS138B=1; LS138C=1; break;
  78   4            case 7:LS138A=1; LS138B=1; LS138C=1; break;
  79   4            
  80   4             }
  81   3      
  82   3          delay(150);
  83   3         }
  84   2      
  85   2        }
  86   1      
  87   1       }
  88          
  89           
  90          
  91           /*************************************
  92           [ T0 (1ms)中断] 中断
  93          
  94          *************************************/
  95          void T0zd(void) interrupt 1      //3定时器1的中断号  1定时器0的中断号 0外部中断1 2外部中断2  4串口中断
  96          {
  97   1         //TH0 = 0xFc;    //12.000
  98   1         //TL0 = 0x18;
  99   1      
 100   1         TH0 = (8192 - 1000)/32 ;
 101   1         TL0 = (8192 - 1000)%32;
 102   1      
 103   1         LedNumVal++;
 104   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    335    ----
   CONSTANT SIZE    =     21    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     18       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
C51 COMPILER V9.54   TIMEER0                                                               07/27/2020 10:50:40 PAGE 3   

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
